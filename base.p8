pico-8 cartridge // http://www.pico-8.com
version 39
__lua__
-- init - called on run`
function _init()
cls()

 objlist=nil

#include collision.lua

--debug switch
debugint=1

mode = "initdebug"

player = create_object("player",0,0,0,8,8)
create_object("wall",1,80,40,16,16)
create_object("wall",1,20,100,16,16)
create_object("wall",1,40,120,16,16)
create_object("wall",1,40,60,16,16)

end
-->8
-- update - called on every frame
function _update()

if mode=="initdebug" then initdebug() end
if mode=="test" then testmode() end
if mode=="test2" then testmode2() end

end
-->8
-- test - test mode
function testmode()

cls()

drawallobj()

if debugint==1 then printlist() end
if btn(1) then player.x=player.x+1 checkallcol(player) end
if btn(0) then player.x=player.x-1 checkallcol(player) end
if btn(2) then player.y=player.y-1 checkallcol(player) end
if btn(3) then player.y=player.y+1 checkallcol(player) end

end

function drawallobj()
 	local temp = objlist
		while temp do
			temp.value.draw(temp.value)
			temp = temp.next
		end
end

function checkallcol(obj1)
 	local temp = objlist
		while temp do
			if (obj1.id!=temp.value.id and checkcol(obj1, temp.value)==true) then return end
			temp = temp.next
		end
		obj1.oldx=obj1.x
		obj1.oldy=obj1.y
end

function checkcol(obj1, obj2)
 bool = sprcoll(obj1.x,obj1.y,obj1.width,obj1.height,obj2.x,obj2.y,obj2.width,obj2.height)
	if bool==true then obj1.x=obj1.oldx obj1.y=obj1.oldy end 
	return bool
end
 
function testmode2()

cls()

print"hello, this is a test mode."
end

function initdebug()

cls()

print"press ðŸ…¾ï¸ for mode 1,\npress âŽ for mode 2"

if btn(4) then mode = "test" end
if btn(5) then mode = "test2" end

end
-->8
-- create_object(unique id,sprite number, x position, y position, object width, object height)
function create_object(uid,rsprite,rx,ry,rwidth,rheight)
a={
oldx = rx, --previous x
oldy = ry, --previous y
sprite=rsprite, --sprite number
x=rx, --x position
y=ry, --y position
width=rwidth, --object width
height=rheight, --object height
id=uid, --unique id
}

	function a.draw(obj)
		spr(obj.sprite,obj.x,obj.y,obj.width/8,obj.height/8)
	end

addtolist(a)

return a
end

 
function addtolist(a)
 	objlist= {
 		next=objlist,
 		value=a
 	}
 	print("added object"..a.sprite.."\n")
end
 
 function printlist()
  local temp = objlist
  print("object list:")
		while temp do
			print(temp.value.id)
			temp = temp.next
		end
	end
	
__gfx__
66666666555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66066066556666666666667500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666555666666666677500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666555566666666777500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
60666606555556666667777500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66000066555555666677777500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666555555566777777500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666555555557777777500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555557777777500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555566777777500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555666677777500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555556666667777500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555566666666777500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555666666666677500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000556666666666667500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
